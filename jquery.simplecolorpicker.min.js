var SimpleColorPicker=function(e,o){this.$el=$(e),this.options=o,this.metadata=this.$el.data("options")};SimpleColorPicker.prototype={defaults:{defaultColor:{name:"default (white)",hex:"fff"},borderWidth:1,cellWidth:20,cellHeight:20,cellBorder:1,elWidth:25,elHeight:25,cols:8,colors:[{name:"green",hex:"00aa00"},{name:"red",hex:"cc0000"},{name:"aqua",hex:"039799"},{name:"pink",hex:"b0307a"},{name:"purple",hex:"762ca7"},{name:"orange",hex:"cc6600"},{name:"gray",hex:"555555"},{name:"black",hex:"000000"},{name:"blue",hex:"0000dd"},{name:"white",hex:"ffffff"},{name:"LU secondry 1",hex:"557869"},{name:"LU secondry 2",hex:"869978"},{name:"LU secondry 3",hex:"e3cb8b"},{name:"LU secondry 4",hex:"e1ab6c"},{name:"LU secondry 5",hex:"008375"},{name:"LU secondry 6",hex:"75BF9A"},{name:"LU secondry 7",hex:"64606c"},{name:"LU secondry 8",hex:"c26763"},{name:"LU secondry 9",hex:"48B6AD"},{name:"LU secondry 10",hex:"81B8BB"},{name:"LU secondry 11",hex:"FF7372"},{name:"LU secondry 12",hex:"F9A98E"},{name:"LU secondry 13",hex:"006382"},{name:"LU secondry 14",hex:"C4DAE5"},{name:"LU secondry 15",hex:"8A3E65"},{name:"LU secondry 16",hex:"A4769A"},{name:"LU secondry 17",hex:"324147"},{name:"LU secondry 18",hex:"7faabe"},{name:"LU secondry 19",hex:"bab6a2"},{name:"LU Red",hex:"b5121b"},{name:"LU Grey",hex:"bec0c2"},{name:"LU Dark Grey",hex:"555656"},{name:"MM a",hex:"008080"},{name:"MM b",hex:"D35400"},{name:"MM c",hex:"145A32"},{name:"MM d",hex:"5D6D7E"},{name:"MM e",hex:"006382"},{name:"MM f",hex:"B03A2E"},{name:"MM g",hex:"ff0000"}],iconPos:"right",aniSpeed:50,lsClass:"color-picker-chooser",textCurrentColor:"Current color: "},init:function(){var e=this;return e.config=$.extend(!0,{},e.defaults,e.options,e.metadata),e.config.totalWidth=e.config.cols*(e.config.cellWidth+2*e.config.cellBorder),e.config.totalHeight=Math.ceil(e.config.colors.length/e.config.cols)*(e.config.cellHeight+2*e.config.cellBorder),e.setupInputElement(),e.$cp=e.getPickerMenu(),$("body").append(e.$cp),e.bindPickerEvents(),$(window).resize(function(){e.setPickerPosition(e.$cp)}),e},geticonPos:function(){var e;switch(this.config.iconPos){case"center":e="center";break;case"left":e="4px center";break;case"right":default:e=this.config.elWidth-20+"px"}return e},setupInputElement:function(){var e,o=this,c=o.$el.attr("name").substring(0,2);"fr"==c?(e=""!=$("#id_sectioncolor").val()?$("#id_sectioncolor").val():"#000000",o.$el.css({backgroundColor:e,backgroundPosition:o.geticonPos(),borderWidth:o.config.borderWidth+"px",width:o.config.elWidth+"px",height:o.config.elHeight+"px",color:"#"+o.$el.val()})):"bg"==c&&(e=""!=$("#id_sectionbgcolor").val()?$("#id_sectionbgcolor").val():"#ffffff",o.$el.css({backgroundColor:e,backgroundPosition:o.geticonPos(),borderWidth:o.config.borderWidth+"px",width:o.config.elWidth+"px",height:o.config.elHeight+"px",color:"#"+o.$el.val()}))},close:function(){this.$cp.slideUp(this.config.aniSpeed).find("li").removeClass("selected"),this.$el.removeClass("open").focus(),$(document).off("mouseup.cp"+this.colorPickerInstance,"html")},open:function(){var e=this;e.setPickerPosition(e.$cp),e.$el.addClass("open"),e.$cp.slideDown(e.config.aniSpeed),$(document).on("mouseup.cp"+e.colorPickerInstance,"html",function(){e.close.call(e)})},setPickerPosition:function(e){var o=this.$el.offset(),c=this.$el.height();e.css({top:o.top+c+this.config.borderWidth,left:o.left})},getCells:function(){var e,o,c=this,n=c.config.colors.length,s=$("<div/>");for(e=0;e<n;e++)(o=$("<li tabindex='0' title='"+c.config.colors[e].name+"' data-color='"+c.config.colors[e].hex+"'></li>")).css({width:c.config.cellWidth+"px",height:c.config.cellHeight+"px",borderWidth:c.config.cellBorder+"px",backgroundColor:"#"+c.config.colors[e].hex}),s.append(o);return s},getPickerMenu:function(){var e=this;e.colorPickerInstance=$("."+e.config.lsClass).length+1;var o,c=$("<ul class='"+e.config.lsClass+"' id='cp-"+e.colorPickerInstance+"' />");return e.setPickerPosition(c),c.css({borderWidth:e.config.borderWidth+"px",width:"324px",display:"none"}),o=e.getCells(),c.append(o.children()),c},bindPickerEvents:function(){var e=this,o=e.$cp.find("li");e.$el.bind({mouseup:function(o){e.$cp.is(":visible")?e.close():e.open(),o.stopPropagation()},keydown:function(o){switch(o.which){case 13:e.$el.trigger("mouseup");break;case 27:e.close(),o.stopPropagation();break;case 40:e.open(),e.$cp.find("li:first").focus().addClass("selected");break;case 9:e.$cp.is(":visible")&&(e.$cp.find("li:first").focus().addClass("selected"),o.preventDefault())}}}),o.bind({keydown:function(o){var c=$(this),n=c.siblings().addBack();switch(o.which){case 13:c.trigger("mouseup");break;case 27:c.removeClass("selected"),e.close(),o.stopPropagation();break;case 37:0===c.prevAll().length?c.removeClass("selected").siblings(":last").focus().addClass("selected"):c.removeClass("selected").prev().focus().addClass("selected");break;case 38:var s=n.index(c)-e.config.cols;s>-1?(c.removeClass("selected"),$(n[s]).addClass("selected").focus()):(c.removeClass("selected"),e.close());break;case 39:case 9:0===c.nextAll().length?c.removeClass("selected").siblings(":first").focus().addClass("selected"):c.removeClass("selected").next().focus().addClass("selected");break;case 40:var i=n.index(c)+e.config.cols;i<n.length&&(c.removeClass("selected"),$(n[i]).addClass("selected").focus())}return!1},mouseup:function(o){var c=$(this);c.siblings().addBack().removeClass("selected");var n=c.attr("data-color"),s=c.attr("title");e.$el.val(n).removeClass("open").focus().css({backgroundColor:"#"+n,color:"#"+n}).attr({title:e.config.textCurrentColor+s,value:"#"+n});var i=e.$el.attr("name").substring(0,2);return"fr"==i?$("#id_sectioncolor").val("#"+n):"bg"==i&&$("#id_sectionbgcolor").val("#"+n),e.close(),o.stopPropagation(),!1}})}},$.fn.simpleColorPicker=function(e){return this.each(function(){new SimpleColorPicker(this,e).init()})};
